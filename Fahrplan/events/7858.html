<!DOCTYPE html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type">
<title>Schedule 33. Chaos Communication Congress</title>
<link rel="stylesheet" media="screen" href="/congress/2016/Fahrplan/assets/public_schedule-fe5c2995f8fa4b0f51bd82df5c41e84e7e7c12485fe767c4a3cf56ad83b2844e.css">
<link rel="stylesheet" media="all" href="/congress/2016/Fahrplan/style.css">
<link rel="stylesheet" media="print" href="/congress/2016/Fahrplan/assets/public_schedule_print-99d3251f43ed74e6a77a8013f74ce1ee07c4de819a619a15d8b8bb5dc9d4dad1.css">
</head>
<body>
<div id="wrapper">
<div id="banner"></div>
<div id="header">
<h1>Schedule 33. Chaos Communication Congress</h1>
</div>
<div id="navigation">
<ul>
<li>
<a href="/congress/2016/Fahrplan/schedule.html">Overview</a>
</li>
<li>
<a href="/congress/2016/Fahrplan/schedule/0.html">
Tuesday
 - 
<span class="small-font">2016-12-27</span>
</a>
</li>
<li>
<a href="/congress/2016/Fahrplan/schedule/1.html">
Wednesday
 - 
<span class="small-font">2016-12-28</span>
</a>
</li>
<li>
<a href="/congress/2016/Fahrplan/schedule/2.html">
Thursday
 - 
<span class="small-font">2016-12-29</span>
</a>
</li>
<li>
<a href="/congress/2016/Fahrplan/schedule/3.html">
Friday
 - 
<span class="small-font">2016-12-30</span>
</a>
</li>
<li>
<a href="/congress/2016/Fahrplan/speakers.html">Speakers</a>
</li>
<li class="selected">
<a href="/congress/2016/Fahrplan/events.html">Events</a>
</li>
<li>
<a href="/congress/2016/Fahrplan/qrcode.html">QR-Code</a>
</li>
</ul>

</div>
<div id="main-content">
<p class="release">
Version INTERIM VERSION
</p>
<h2>lecture: Exploiting PHP7 unserialize</h2>
<h3 class="title">teaching a new dog old tricks</h3>
<div class="column left" id="basic">
<div class="image large"><img src="/congress/2016/Fahrplan/assets/event_large-4b8aa978adbb7c8e80151f5a83c6782a12e763374ae3a042a55e7e626a64d93b.png" alt="Event large"></div>
<p class="abstract">PHP-7 is a new version of the most prevalent server-side language in use today. Like previous version, this version is also vulnerable to memory corruptions.
<br>However, the language has gone through extensive changes and none of previous exploitation techniques are relevant.
<br>In this talk, we explore the new memory internals of the language from exploiters and vulnerability researchers point of view. We will explain newly found vulnerabilities in the 'unserialize' mechanism of the language and present re-usable primitives for remote exploitation of these vulnerabilities.</p>
<p class="description">PHP is the most prominent web server-side language used today. Although secure coding practices are used when developing in PHP, they can’t mitigate vulnerabilities in the language itself. Since PHP is written in C, it is exposed to vulnerabilities found in projects written in a low-level language, such as memory-corruption vulnerabilities, which are common when manipulating data formats. PHP-7 is a new implementation of the language, and while memory corruption bugs exist in this version as well, none of the exploitation primitives from the previous version are working (e.g. @i0n1c presentation from BH2010). 
<br>In this talk, I will discuss the memory internals of PHP7 from exploiter and vulnerability researcher's perspective, explain newly found vulnerabilities in the unserialize mechanism and demonstrate how to exploit this class of bugs in PHP-7 presenting re-usable primitives.
<br>The internals of the language implementation changed quite dramatically, and now it’s harder to find and exploit memory corruption bugs. The new zval system prefers embedding over pointing to members and the allocation mechanism has gone through a complete re-write, removing metadata. The overall result is less primitives and less control over crafted data. unserialize is a data manipulation and object instantiation mechanism in PHP which is prone to memory corruption vulnerabilities.  For the first time, we have managed to implement a remote exploit of a real world bug in PHP-7unserialize mechanism.</p>
</div>
<div class="column left" id="details">
<h3>Info</h3>
<p>
<b>Day:</b>
<a href="/congress/2016/Fahrplan/schedule/0.html">2016-12-27</a>
<br>
<b>Start time:</b>
12:45
<br>
<b>Duration:</b>
01:00
<br>
<b>Room:</b>
Saal 6
<br>
<b>Track:</b>
<font class="event track-security">
<a href="/congress/2016/Fahrplan/events.html#security">Security</a>
</font>
<br>
<b>Language:</b>
en
</p>
<h3>Links:</h3>
<ul>
<li><a href="/congress/2016/Fahrplan/events/7858.ics">iCalendar</a></li>
<li><a href="http://blog.checkpoint.com/wp-content/uploads/2016/08/Exploiting-PHP-7-unserialize-Report-160829.pdf">pdf outlining the exploitation primitives which will be discussed</a></li>
</ul>
<div class="column left" id="concurrent_events">
<h3><span class="translation_missing" title="translation missing: en.public.schedule.event.concurrent_events">Concurrent Events</span></h3>
<dl class="dl-horizontal">
<dt>Saal 2</dt>
<dd><a href="/congress/2016/Fahrplan/events/8127.html">How Do I Crack Satellite and Cable Pay TV?</a></dd>
<dt>Saal 1</dt>
<dd><a href="/congress/2016/Fahrplan/events/8295.html">The Fight for Encryption in 2016</a></dd>
<dt>Saal G</dt>
<dd><a href="/congress/2016/Fahrplan/events/8338.html">Building a high throughput low-latency PCIe based SDR</a></dd>
</dl>
</div>
</div>
<div class="column right" id="sidebar">
<h3>Speakers</h3>
<table class="list">
<tbody>
<tr>
<td><div class="image small"><img src="/congress/2016/Fahrplan/assets/person_small-6becbdd9bedc5ac3962dfb66f90e5ebb8fdbb97c287002e97bba3762a122a2bf.png" alt="Person small"></div></td>
<td><a href="/congress/2016/Fahrplan/speakers/6716.html">Yannay Livneh</a></td>
</tr>
</tbody>
</table>
</div>
<div class="span16">
</div>

<br class="clear">
</div>
</div>
</body>
</html>
